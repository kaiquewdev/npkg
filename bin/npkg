#!/usr/bin/env coffee

log = require 'node-log'
log.setName 'npkg'
  
nopt = require 'nopt'
path = require 'path'

known =
  in: path
  out: path

short =
  i: ['--in']
  o: ['--out']       
           
parsed = nopt known, short, process.argv, 2
return log.error 'Please enter all required parameters' unless parsed.in and parsed.out
  
logo =  ''
logo += '               _           \r\n'
logo += '              | |          \r\n'
logo += ' ____   ____  | |  _  ____ \r\n'
logo += '|  _ \\ |  _ \\ | |_/ )/ _  |\r\n'
logo += '| | | || |_| ||  _ (( (_| |\r\n'
logo += '|_| |_||  __/ |_| \\_)\\___ |\r\n'
logo += '       |_|          (_____|\r\n'
console.log logo
  
npkg = require '../lib/main'
basedir = './temp/'
try
  npkg.build basedir, parsed, ->
    log.info 'Build completed! - Files located at ' + parsed.out
    # rimraf.sync basedir
catch err
  log.error 'Build failed! - Error: ' + err
    # rimraf.sync basedir
