#!/usr/bin/env coffee

log = require 'node-log'
log.setName 'npkg'
  
nopt = require 'nopt'
path = require 'path'

known =
  in: path
  out: path
  # arch: ['windows', 'debian', 'osx']
  arch: ['debian']

short =
  i: ['--in']
  o: ['--out']
  t: ['--arch']       
           
parsed = nopt known, short, process.argv, 2
log.info 'Starting npkg. Architecture: ' + parsed.arch
  
try
  npkg = require '../lib/main'
  npkg.build npkg[parsed.arch], parsed
catch err
  log.error 'Build failed! - Error: ' + err
  throw err if err
finally
  log.info 'Build completed! - Files located at ' + parsed.out
